プロジェクト：車両テレメトリ・制御統合基盤



■概要  
本プロジェクトの目的は、車両の状態取得と制御を安全かつリアルタイムに実現するクラウド連携基盤を構築することです。
ユーザー操作から車両へのコマンド送信、車両からのテレメトリ収集までを一貫して扱えるアーキテクチャを設計・実装し、遠隔操作と状態管理を高信頼に行える仕組みを確立しました。
なお、アプリケーションはスマートフォンからの利用を前提としています。


■アーキテクチャ  
![Architecture](docs/architecture.svg)

■技術スタック  
UI / 操作系  
- AWS Amplify（ユーザー操作の入口）  
- Next.js（車両状態表示・コマンド送信 UI）  

制御ロジック / API
- FastAPI（車両制御 API）
- EC2（制御ロジックの実行環境）

データ管理
- DynamoDB（車両状態・コマンドの永続化）
- DynamoDB Streams（イベントトリガー）

車両通信
- AWS IoT Core（車両との MQTT 通信）
- MQTT（リアルタイム制御）
- AWS Lambda（DynamoDB Streams を受けて車両へターゲット値を送信）

検証環境
- 車両シミュレーター（ECU 動作の模擬）


■主要機能
- 車両状態取得
  本プロジェクトでは、アイテムとして以下を取得
  ・
- 車両制御
  本プロジェクトでは、以下項目を操作可能
  ・自動車ドアロック、アンロック
  ・エアコン設定温度
- テレメトリ収集
- イベント駆動処理

■工夫点
- 車両の安全思想を反映した「状態遷移ロジック」の実装

単なるデータの可視化に留まらず、実車の制御を想定した「3秒間の完全静止判定」ロジックをシミュレータ側に実装しました。通信の遅延や誤操作があっても、車両が安全な状態（静止）であることをソフトウェア側で保証してから次の動作へ移行するという、モビリティ開発において不可欠なフェイルセーフの考え方を設計に取り入れました。

- AWS IoT Coreを採用した「低遅延・双方向」の通信基盤

車両とクラウド間のリアルタイム性を確保するため、MQTTプロトコルを採用したAWS IoT Coreによる通信基盤を構築しました。100ms周期の高頻度なテレメトリ送信と、ブラウザ（Next.js）からのコマンド送出を双方向で実現。コネクテッドカーの肝となる**「車両とクラウドの密な連携」**を、実装レベルで再現しました。

- クラウド側での「生存監視（LWT）」による接続状態の可視化

車両側からの通信が途絶えた際、クラウド側（AWS IoT Core）で即座に検知し、フロントエンドに「オフライン」であることを正確に表示する仕組みを構築しました。具体的には MQTTのLWT（Last Will and Testament：遺言機能） 等の概念を想定し、通信断発生時に「古い（不正確な）車両ステータス」をユーザーに見せ続けないための配慮を行いました。これにより、ユーザーに対して常にシステムの信頼性を担保するUI/UXを追求しました。


■課題(今後の改善点)

